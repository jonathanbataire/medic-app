{
  "locales": [
    {
      "code": "en",
      "name": "English"
    },
    {
      "code": "es",
      "name": "Español (Spanish)"
    },
    {
      "code": "fr",
      "name": "Français (French)"
    },
    {
      "code": "ne",
      "name": "नेपाली (Nepali)"
    },
    {
      "code": "sw",
      "name": "Kiswahili (Swahili)"
    }
  ],
  "locale": "en",
  "locale_outgoing": "en",
  "date_format": "DD-MMM-YYYY",
  "reported_date_format": "DD-MMM-YYYY HH:mm:ss",
  "forms_only_mode": false,
  "place_hierarchy_types": [
    "district_hospital",
    "health_center"
  ],
  "default_responses": {
    "start_date": ""
  },
  "district_admins_access_unallocated_messages": false,
  "public_access": false,
  "default_country_code": 1,
  "gateway_number": "+13125551212",
  "kujua-reporting": [
    {
      "code": "VPD",
      "reporting_freq": "weekly"
    }
  ],
  "schedule_morning_hours": 0,
  "schedule_morning_minutes": 0,
  "schedule_evening_hours": 23,
  "schedule_evening_minutes": 0,
  "synthetic_date": "",
  "contact_display_short": "clinic.name",
  "roles": {
    "national_admin": {
      "name": "usertype.national-manager"
    },
    "district_admin": {
      "name": "usertype.district-manager",
      "offline": true
    },
    "data_entry": {
      "name": "usertype.data-entry"
    },
    "analytics": {
      "name": "usertype.analytics"
    },
    "gateway": {
      "name": "usertype.gateway"
    }
  },
  "permissions": [
    {
      "name": "can_export_messages",
      "roles": [
        "national_admin",
        "district_admin",
        "analytics"
      ]
    },
    {
      "name": "can_export_forms",
      "roles": [
        "national_admin",
        "district_admin",
        "analytics"
      ]
    },
    {
      "name": "can_export_contacts",
      "roles": [
        "national_admin",
        "district_admin"
      ]
    },
    {
      "name": "can_export_audit",
      "roles": [
        "national_admin"
      ]
    },
    {
      "name": "can_export_feedback",
      "roles": [
        "national_admin"
      ]
    },
    {
      "name": "can_view_data_records",
      "roles": [
        "national_admin",
        "district_admin",
        "analytics",
        "gateway"
      ]
    },
    {
      "name": "can_view_unallocated_data_records",
      "roles": [
        "national_admin",
        "district_admin",
        "gateway"
      ]
    },
    {
      "name": "can_view_users",
      "roles": [
        "national_admin"
      ]
    },
    {
      "name": "can_edit",
      "roles": [
        "national_admin",
        "district_admin",
        "gateway"
      ]
    },
    {
      "name": "can_update_messages",
      "roles": [
        "national_admin",
        "district_admin",
        "gateway"
      ]
    },
    {
      "name": "can_update_users",
      "roles": [
        "national_admin"
      ]
    },
    {
      "name": "can_update_people",
      "roles": [
        "district_admin"
      ]
    },
    {
      "name": "can_update_places",
      "roles": [
        "district_admin"
      ]
    },
    {
      "name": "can_create_records",
      "roles": [
        "national_admin",
        "district_admin",
        "data_entry",
        "gateway"
      ]
    },
    {
      "name": "can_access_gateway_api",
      "roles": [
        "gateway"
      ]
    },
    {
      "name": "can_create_users",
      "roles": [
        "national_admin"
      ]
    },
    {
      "name": "can_create_people",
      "roles": [
        "district_admin"
      ]
    },
    {
      "name": "can_create_places",
      "roles": [
        "district_admin"
      ]
    },
    {
      "name": "can_view_tasks",
      "roles": [
        "district_admin"
      ]
    },
    {
      "name": "can_view_tasks_tab",
      "roles": [
        "district_admin"
      ]
    },
    {
      "name": "can_configure",
      "roles": [
        "national_admin"
      ]
    },
    {
      "name": "can_view_messages",
      "roles": [
        "national_admin",
        "district_admin"
      ]
    },
    {
      "name": "can_view_messages_tab",
      "roles": [
        "national_admin",
        "district_admin"
      ]
    },
    {
      "name": "can_view_reports",
      "roles": [
        "national_admin",
        "district_admin"
      ]
    },
    {
      "name": "can_view_reports_tab",
      "roles": [
        "national_admin",
        "district_admin"
      ]
    },
    {
      "name": "can_view_analytics",
      "roles": [
        "national_admin",
        "district_admin",
        "analytics"
      ]
    },
    {
      "name": "can_view_analytics_tab",
      "roles": [
        "national_admin",
        "district_admin"
      ]
    },
    {
      "name": "can_view_contacts",
      "roles": [
        "national_admin",
        "district_admin"
      ]
    },
    {
      "name": "can_view_contacts_tab",
      "roles": [
        "national_admin",
        "district_admin"
      ]
    },
    {
      "name": "can_edit_profile",
      "roles": [
        "national_admin",
        "district_admin"
      ]
    },
    {
      "name": "can_delete_reports",
      "roles": [
        "national_admin",
        "district_admin"
      ]
    },
    {
      "name": "can_bulk_delete_reports",
      "roles": [
        "national_admin",
        "district_admin"
      ]
    },
    {
      "name": "can_delete_contacts",
      "roles": [
        "national_admin",
        "district_admin"
      ]
    },
    {
      "name": "can_delete_messages",
      "roles": [
        "national_admin",
        "district_admin"
      ]
    },
    {
      "name": "can_delete_users",
      "roles": [
        "national_admin"
      ]
    },
    {
      "name": "can_view_message_action",
      "roles": [
        "national_admin",
        "district_admin"
      ]
    },
    {
      "name": "can_view_call_action",
      "roles": [
        "national_admin",
        "district_admin"
      ]
    },
    {
      "name": "can_log_out_on_android",
      "roles": []
    },
    {
      "name": "can_verify_reports",
      "roles": [
        "national_admin",
        "district_admin"
      ]
    },
    {
      "name": "can_view_last_visited_date",
      "roles": [
        "district_admin"
      ]
    },
    {
      "name": "can_write_wealth_quintiles",
      "roles": []
    }
  ],
  "changes_controller": {
    "reiterate_changes": true,
    "changes_limit": 100,
    "debounce_interval": 200
  },
  "uhc": {
    "contacts_default_sort": "",
    "visit_count": {
      "month_start_date": 1,
      "visit_count_goal": 0
    }
  },
  "setup_complete": true,
  "contact_summary": "var cards=[],context={},fields=[];if('person'===contact.type){var pregnancy,pregnancyDate;fields=[{label:'patient_id',value:contact.patient_id,width:3},{label:'contact.sex',value:contact.sex,width:3},{label:'Notes',value:contact.notes,width:12},{label:'contact.age',value:contact.date_of_birth,width:4,filter:'age'},{label:'Phone Number',value:contact.phone,width:8,filter:'phone'},{label:'contact.parent',value:lineage,filter:'lineage'}],context.pregnant=!1;var today=new Date,lmp_45wks=new Date;lmp_45wks.setDate(today.getDate()-315),reports.forEach(function(t){if('pregnancy'===t.form){var e=new Date(t.fields.lmp_date);if(0<reports.filter(function(e){return'delivery'===e.form&&e.reported_date>t.reported_date}).length||e<lmp_45wks)return;var r=reports.filter(function(e){return'pregnancy_visit'===e.form&&e.reported_date>t.reported_date}),a=reports.filter(function(e){return'pregnancy_check'===e.form&&e.reported_date>t.reported_date});context.pregnant=!0;var n=t.fields.edd_8601,o=t.reported_date;r.forEach(function(e){e.reported_date>o&&(e.fields.g_overview&&e.fields.g_overview.pregnant&&(context.pregnant='no'!==e.fields.g_overview.pregnant),e.fields.g_overview&&'yes'===e.fields.g_overview.update_edd&&(n=e.fields.edd_8601)),o=e.reported_date});var d=t.reported_date;a.forEach(function(e){e.reported_date>d&&(e.fields.g_overview&&e.fields.g_overview.pregnant&&(context.pregnant='no'!==e.fields.g_overview.pregnant),e.fields.g_overview&&'yes'===e.fields.g_overview.update_edd&&(n=e.fields.edd_8601)),d=e.fields.reported_date}),(!pregnancy||pregnancyDate<t.reported_date)&&(pregnancyDate=t.reported_date,pregnancy={label:'contact.profile.pregnancy',fields:[{label:'contact.profile.edd',value:n,filter:'simpleDate'},{label:'contact.profile.visit',value:'contact.profile.visits.of',translate:!0,context:{count:r.length,total:4}}]})}context.childIsDead=!1,context.motherIsDead=!1;var i='',l='';'postnatal_care'===t.form&&(l=void 0===t.fields.group_delivery_summary?'alive':t.fields.group_delivery_summary.mother_condition,i=t.fields.group_delivery_summary.g_pregnancy_outcome,context.motherIsDead='dead'===l,context.chilsIsDead='still_birth'===i||'miscarriage'===i),'assessment'===t.form&&t.fields.group_assess&&(i=t.fields.group_assess.is_alive,context.childIsDead='no'===i),'assessment_follow_up'===t.form&&(i=t.fields.group_better.g_patient_better,context.childIsDead='died'===i)}),pregnancy&&context.pregnant&&cards.push(pregnancy)}else'clinic'===contact.type||contact.type;var result={fields:fields,cards:cards,context:context};return result;",
  "tasks": {
    "rules": "define Target {_id: null,deleted: null,type: null,pass: null,date: null}define Contact {contact: null,reports: null}define Task {_id: null,deleted: null,doc: null,contact: null,icon: null,date: null,title: null,fields: null,resolved: null,priority: null,priorityLabel: null,reports: null,actions: null}rule GenerateEvents {when {c: Contact}then {var idx1,idx2,r,target,now=Utils.now(),targets=[{id:'pregnancies-this-month',appliesTo:'reports',date:'reported',appliesIf:function(e,t){return'pregnancy_registration'===t.form}},{id:'percentage-of-pregnancies',appliesTo:'contacts',date:'now',passesIf:function(e){return'true'===e.contact.pregnant_at_registration},appliesToType:['person','clinic'],appliesIf:function(e){return'female'===e.contact.sex&&('true'===e.contact.pregnant_at_registration||'false'===e.contact.pregnant_at_registration)}},{id:'total-number-of-patients',appliesTo:'contacts',date:'now',appliesToType:['person'],appliesIf:function(e){return'person'===e.contact.type&&e.contact.parent.parent.parent}}],tasks=[{icon:'pregnant',title:'task.pregnancy.registration',appliesTo:'contacts',appliesToType:['person'],appliesIf:function(e){return'true'===e.contact.pregnant_at_registration},actions:[{form:'pregnancy_registration'}],resolvedIf:function(e,t,a,r){return Utils.isFormSubmittedInWindow(e.reports,'pregnancy_registration',r,Utils.addDate(r,a.end+1).getTime())},events:[{days:0,start:0,end:7}]}];for(idx1=0;idx1<targets.length;++idx1)switch((target=targets[idx1]).appliesTo){case'contacts':c.contact&&-1!==target.appliesToType.indexOf(c.contact.type)&&emitContactBasedTargetFor(c,target);break;case'reports':for(idx2=0;idx2<c.reports.length;++idx2)r=c.reports[idx2],emitReportBasedTargetFor(c,r,target);break;default:throw new Error('unrecognised target type: '+target.appliesTo)}if(tasks)for(idx1=0;idx1<tasks.length;++idx1){var task=tasks[idx1];switch(task.appliesTo){case'reports':case'scheduled_tasks':for(idx2=0;idx2<c.reports.length;++idx2)r=c.reports[idx2],emitTasksForSchedule(c,task,r);break;case'contacts':c.contact&&-1!==task.appliesToType.indexOf(c.contact.type)&&emitTasksForSchedule(c,task);break;default:throw new Error('unrecognised task type: '+task.appliesTo)}}function emitTasksForSchedule(i,o,c){var e;if((!c||!o.appliesToType||-1!==o.appliesToType.indexOf(c.form))&&('scheduled_tasks'===o.appliesTo||!o.appliesIf||o.appliesIf(i,c)))if('scheduled_tasks'===o.appliesTo){if(c&&o.appliesIf){if(!c.scheduled_tasks)return;for(e=0;e<c.scheduled_tasks.length;e++)o.appliesIf(i,c,e)&&t(e)}}else t();function t(e){var t,a,r,n,s=null;for(t=0;t<o.events.length;t++)a=o.events[t],s=c?a.dueDate?a.dueDate(c,a,e):void 0!==e?new Date(Utils.addDate(new Date(c.scheduled_tasks[e].due),a.days)):new Date(Utils.addDate(new Date(c.reported_date),a.days)):a.dueDate?a.dueDate(i.contact,a,e):new Date(Utils.addDate(new Date(i.contact.reported_date),a.days)),Utils.isTimely(s,a)&&(n={_id:c?c._id+'-'+a.id:i.contact._id+'-'+o.id,deleted:!(!(i.contact&&i.contact.deleted||c)||!c.deleted),doc:i,contact:i.contact,icon:o.icon,date:s,title:o.title,resolved:o.resolvedIf(i,c,a,s,e),actions:o.actions.map(d)},void 0!==e&&(n._id+='-'+e),'function'==typeof(r=o.priority)&&(r=r(i,c)),r&&(n.priority=r.level,n.priorityLabel=r.label),emit('task',new Task(n)))}function d(e){var t={source:'task',source_id:c&&c._id,contact:i.contact};return e.modifyContent&&e.modifyContent(c,t),{type:'report',form:e.form,label:e.label||'Follow up',content:t}}}function emitContactBasedTargetFor(e,t){if(!t.appliesIf||t.appliesIf(e)){var a=!t.passesIf||!!t.passesIf(e),r=createTargetInstance(t.id,e.contact,a);if('function'==typeof t.date)r.date=t.date(e);else if(void 0===t.date||'now'===t.date)r.date=now.getTime();else{if('reported'!==t.date)throw new Error('Unrecognised value for target.date: '+t.date);r.date=e.reported_date}emitTargetInstance(r)}}function emitReportBasedTargetFor(e,t,a){var r,n;if(!a.appliesIf||a.appliesIf(e,t))if(a.emitCustom)a.emitCustom(e,t);else switch(n=!a.passesIf||!!a.passesIf(e,t),(r=createTargetInstance(a.id,t,n))._id=('report'===a.idType?t._id:e.contact._id)+'-'+a.id,emitTargetInstance(r),a.date){case'now':r.date=now.getTime()}}function createTargetInstance(e,t,a){return new Target({_id:t._id+'-'+e,deleted:!!t.deleted,type:e,pass:a,date:t.reported_date})}function emitTargetInstance(e){emit('target',e)}emit('_complete',{_id:!0});}}",
    "schedules": {},
    "targets": {
      "enabled": true,
      "items": [
        {
          "id": "pregnancies-this-month",
          "type": "reported",
          "goal": -1,
          "translation_key": "targets.pregnancies.title",
          "subtitle_translation_key": "targets.pregnancies.subtitle",
          "icon": "pregnant"
        },
        {
          "id": "percentage-of-pregnancies",
          "type": "percent",
          "goal": 40,
          "translation_key": "targets.percentage.pregnancies.title",
          "subtitle_translation_key": "targets.percentage.pregnancies.subtitle",
          "icon": "pregnant"
        },
        {
          "id": "total-number-of-patients",
          "type": "count",
          "goal": 4,
          "translation_key": "targets.people.title",
          "subtitle_translation_key": "targets.people.subtitle",
          "icon": "people-children"
        }
      ]
    }
  }
}
